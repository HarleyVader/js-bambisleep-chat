<!-- profiles.ejs using express-ejs-layouts -->
<% layout('./layouts/main') -%>
<% block('title', 'BambiSleep Community') -%>

<div class="page-header">
  <h1>BambiSleep Community</h1>
  <p class="subtitle">Connect with other Bambis and explore the forest together</p>
</div>

<div class="create-profile-section">
  <h2>Join Our Community</h2>
  <p>Share your journey into blissful mindlessness with others</p>
  
  <a href="/profile/new" class="join-community-btn">Create Profile</a>
</div>

<h2 class="section-title">Explore Bambi Profiles</h2>

<div class="profiles-grid">
  <% if (profiles && profiles.length > 0) { %>
    <% profiles.forEach(profile => { %>
      <div class="profile-card">
        <img src="<%= profile.avatar || '/gif/default-avatar.gif' %>" alt="<%= profile.displayName || profile.username %>" class="profile-avatar">
        <h3 class="profile-name"><%= profile.displayName || profile.username %></h3>
        <div class="profile-stats">
          <div class="stat">
            <div class="stat-value"><%= (profile.seasons && profile.seasons.length) || 0 %></div>
            <div class="stat-label">Seasons</div>
          </div>
          <div class="stat">
            <div class="stat-value"><%= (profile.triggers && profile.triggers.length) || 0 %></div>
            <div class="stat-label">Triggers</div>
          </div>
        </div>
        <div class="profile-description">
          <%= profile.description && profile.description.length > 120 ? 
            profile.description.substring(0, 120) + '...' : 
            profile.description || 'A mysterious Bambi...' %>
        </div>
        <div class="profile-actions">
          <a href="/profile/<%= profile.username %>" class="view-profile-btn">View Profile</a>
        </div>
      </div>
    <% }); %>
  <% } else { %>
    <div class="empty-profiles">
      <div class="empty-message">
        <p>No profiles found. Be the first to create one!</p>
        <a href="/profile/new" class="join-community-btn">Create Profile</a>
      </div>
    </div>
  <% } %>
</div>